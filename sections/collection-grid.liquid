<section class="section-spacing">
  <div class="page-width">
    <div class="section-header">
      {%- if section.settings.label != blank -%}
        <span class="section-header__label label-caps text-muted">{{ section.settings.label }}</span>
      {%- endif -%}

      {%- if section.settings.heading != blank -%}
        <h2 class="section-header__title h2">{{ section.settings.heading }}</h2>
      {%- endif -%}
    </div>

    {%- liquid
      assign has_assigned_collections = false
      for block in section.blocks
        if block.settings.collection != blank
          assign has_assigned_collections = true
          break
        endif
      endfor
    -%}

    {%- if section.settings.layout == 'scroll' -%}
      <div class="collection-scroll">
        {%- if has_assigned_collections -%}
          {%- for block in section.blocks -%}
            {%- if block.settings.collection != blank -%}
              {% render 'collection-card', collection: block.settings.collection %}
            {%- endif -%}
          {%- endfor -%}
        {%- else -%}
          {%- for collection in collections limit: 6 -%}
            {%- unless collection.handle == 'all' -%}
              {% render 'collection-card', collection: collection %}
            {%- endunless -%}
          {%- endfor -%}
        {%- endif -%}
      </div>
    {%- else -%}
      <div class="grid grid--{{ section.settings.columns }}">
        {%- if has_assigned_collections -%}
          {%- for block in section.blocks -%}
            {%- if block.settings.collection != blank -%}
              {% render 'collection-card', collection: block.settings.collection %}
            {%- endif -%}
          {%- endfor -%}
        {%- else -%}
          {%- for collection in collections limit: 6 -%}
            {%- unless collection.handle == 'all' -%}
              {% render 'collection-card', collection: collection %}
            {%- endunless -%}
          {%- endfor -%}
        {%- endif -%}
      </div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Collection grid",
  "tag": "section",
  "class": "collection-grid-section",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "default": "Browse",
      "label": "Label"
    },
    {
      "type": "text",
      "id": "heading",
      "default": "Shop by Category",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "layout",
      "default": "scroll",
      "label": "Layout",
      "options": [
        { "value": "scroll", "label": "Horizontal scroll" },
        { "value": "grid", "label": "Grid" }
      ]
    },
    {
      "type": "range",
      "id": "columns",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Columns (grid layout)"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection grid",
      "blocks": [
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" }
      ]
    }
  ]
}
{% endschema %}
